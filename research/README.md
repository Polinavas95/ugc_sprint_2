# Проектная работа 9 спринта. Исследование: выбор хранилища

Цель - выбрать хранилище по результатам исследования 
и тестирования работоспособности MongoDB и ClickHouse
в части вставки и чтении информации о:
* лайках/дизлайках за фильм;
* рецензии на фильм;
* закладок с фильмом.

Тестирование вставки с разными размерами батчей (от 1 до 5000).

#### Порядок проведения тестов
1. Перейти в текущую папку research
mongo
```shell
cd research
```
2. Прописать в консоли команду сборки контейнеров
mongo
```shell
make run test_mongo_db
```
или clickhouse
```shell
make run test_clickhouse_db
```
3. Запустить процесс тестирования с помощью команды
mongo
```shell
python -m mongo.mongodb
```
или clickhouse
```shell
python -m clickhouse.run_clickhouse.py
```


#### Результаты тестирования
1. MongoDB
##### Запись лайков/дизлайков
| Размер Батча | Время записи на батч | Время записи 1 элемента |
|:------------:|:--------------------:|:-----------------------:|
|      1       |       сек       |           сек           |
|      10      |       сек       |           сек           |
|      50      |       сек       |           сек           |
|     100      |       сек       |           сек           |
|     200      |       сек       |           сек           |
|     500      |       сек       |           сек           |
|     1000     |       сек       |           сек           |
|     2000     |       сек       |           сек           |
|     5000     |       сек      |        сек        |

##### Запись рецензии на фильм
| Размер Батча | Время записи на батч | Время записи 1 элемента |
|:------------:|:--------------------:|:-----------------------:|
|      1       |         сек          |           сек           |
|      10      |         сек          |           сек           |
|      50      |         сек          |           сек           |
|     100      |         сек          |           сек           |
|     200      |         сек          |           сек           |
|     500      |         сек          |           сек           |
|     1000     |         сек          |           сек           |
|     2000     |         сек          |           сек           |
|     5000     |         сек          |            сек          |

##### Запись закладок
| Размер Батча | Время записи на батч | Время записи 1 элемента |
|:------------:|:--------------------:|:-----------------------:|
|      1       |       сек       |           сек           |
|      10      |       сек       |           сек           |
|      50      |       сек       |           сек           |
|     100      |       сек       |           сек           |
|     200      |       сек       |           сек           |
|     500      |       сек       |           сек           |
|     1000     |       сек       |           сек           |
|     2000     |       сек      |           сек           |
|     5000     |       сек      |           сек           |


2. ClickHouse
##### Запись лайков/дизлайков
| Размер Батча | Время записи на батч | Время записи 1 элемента |
|:------------:|:--------------------:|:-----------------------:|
|      1       |      20.02 сек       |        20.02 сек        |
|      10      |      20.01 сек       |          2 сек          |
|      50      |      20.01 сек       |         0.4 сек         |
|     100      |      20.01 сек       |         0.2 сек         |
|     200      |      20.01 сек       |         0.1 сек         |
|     500      |      20.06 сек       |        0.04 сек         |
|     1000     |      20.02 сек       |        0.02 сек         |
|     2000     |      20.02 сек       |        0.01 сек         |
|     5000     |      20.02 сек       |        0.004 сек        |

##### Запись рецензии на фильм
| Размер Батча | Время записи на батч | Время записи 1 элемента |
|:------------:|:--------------------:|:-----------------------:|
|      1       |      52.65 сек       |        52.65 сек        |
|      10      |      20.02 сек       |          2 сек          |
|      50      |      20.01 сек       |         0.4 сек         |
|     100      |      46.14 сек       |        0.46 сек         |
|     200      |        20 сек        |         0.1 сек         |
|     500      |        20 сек        |         0.4 сек         |
|     1000     |        20 сек        |        0.02 сек         |
|     2000     |        20 сек        |        0.01 сек         |
|     5000     |      20.02 сек       |        0.004 сек        |

##### Запись закладок
| Размер Батча | Время записи на батч | Время записи 1 элемента |
|:------------:|:--------------------:|:-----------------------:|
|      1       |        20 сек        |         20 сек          |
|      10      |        20 сек        |          2 сек          |
|      50      |      20.017 сек      |         0.4 сек         |
|     100      |      20.018 сек      |         0.2 сек         |
|     200      |      20.016 сек      |         0.1 сек         |
|     500      |      20.018 сек      |        0.04 сек         |
|     1000     |      20.018 сек      |        0.02 сек         |
|     2000     |      20.018 сек      |        0.01 сек         |
|     5000     |      20.02 сек       |        0.004 сек        |

#### Заключение
По результатам работоспособности было решено использовать ClickHouse в качестве хранилища данных.


## Авторы
[Polinavas95](https://github.com/Polinavas95) | <tatsuchan@mail.ru>

[Barahlush](https://github.com/Barahlush) | <baralti va@gmail.com>

